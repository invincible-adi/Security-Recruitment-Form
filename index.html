<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A J Securitas Recruitment Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #e0eafc 0%, #cfdef3 100%);
            min-height: 100vh;
        }

        .form-step {
            display: none;
        }

        .form-step.active {
            display: block;
            animation: fadeIn 0.7s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-container {
            max-width: 900px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 35px 40px 30px 40px;
            border-radius: 18px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.18);
            border: 1.5px solid #e3e3e3;
        }

        .form-container h2 {
            background: linear-gradient(90deg, #0072ff 0%, #00c6ff 100%);
            color: #fff;
            padding: 16px 0 16px 0;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
            letter-spacing: 1px;
        }

        .form-step h4 {
            color: #0072ff;
            font-weight: 600;
            margin-bottom: 22px;
        }

        .form-label {
            color: #0a2540;
            font-weight: 500;
        }

        .required-field::after {
            content: " *";
            color: #dc3545;
        }

        .form-control,
        .form-select {
            border-radius: 8px;
            border: 1.5px solid #b2d8f7;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.03);
            transition: border-color 0.2s;
        }

        .form-control:focus,
        .form-select:focus {
            border-color: #0072ff;
            box-shadow: 0 0 0 2px #b2e0ff55;
        }

        .form-control.is-invalid,
        .form-select.is-invalid {
            border-color: #dc3545;
            background-image: none;
        }

        .form-control.is-invalid:focus,
        .form-select.is-invalid:focus {
            border-color: #dc3545;
            box-shadow: 0 0 0 2px rgba(220, 53, 69, 0.25);
        }

        .error-message {
            color: #dc3545;
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: block;
            font-weight: 500;
            position: absolute;
            width: 100%;
        }

        .mb-3 {
            margin-bottom: 1.5rem !important;
        }

        .form-group {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .invalid-feedback {
            display: none;
            width: 100%;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: #dc3545;
        }

        .is-invalid ~ .invalid-feedback {
            display: block;
        }

        .is-invalid {
            padding-right: calc(1.5em + 0.75rem);
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 12 12' width='12' height='12' fill='none' stroke='%23dc3545'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right calc(0.375em + 0.1875rem) center;
            background-size: calc(0.75em + 0.375rem) calc(0.75em + 0.375rem);
        }

        .is-invalid:focus {
            border-color: #dc3545;
            box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.25);
        }

        .passport-photo-preview {
            width: 120px;
            height: 150px;
            object-fit: cover;
            border: 2px solid #0072ff;
            margin-top: 10px;
            border-radius: 8px;
            background: #f4faff;
        }

        .btn-primary,
        .btn-success {
            background: linear-gradient(90deg, #0072ff 0%, #00c6ff 100%);
            border: none;
            font-weight: 500;
            letter-spacing: 0.5px;
            transition: box-shadow 0.2s;
        }

        .btn-primary:hover,
        .btn-success:hover {
            box-shadow: 0 4px 16px 0 #00c6ff44;
        }

        .btn-secondary {
            background: #fff;
            color: #0072ff;
            border: 1.5px solid #0072ff;
            font-weight: 500;
            transition: background 0.2s, color 0.2s;
        }

        .btn-secondary:hover {
            background: #0072ff;
            color: #fff;
        }

        .alert-info {
            background: linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%);
            color: #0a2540;
            border: none;
            border-radius: 8px;
            font-weight: 500;
        }

        /* Progress bar */
        .progressbar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 35px;
            counter-reset: step;
        }

        .progressbar li {
            list-style-type: none;
            width: 100%;
            position: relative;
            text-align: center;
            color: #b2d8f7;
            font-weight: 500;
        }

        .progressbar li:before {
            content: counter(step);
            counter-increment: step;
            width: 32px;
            height: 32px;
            line-height: 32px;
            border: 2px solid #b2d8f7;
            display: block;
            text-align: center;
            margin: 0 auto 8px auto;
            border-radius: 50%;
            background: #fff;
            font-size: 1.1rem;
        }

        .progressbar li:after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background: #b2d8f7;
            top: 16px;
            left: -50%;
            z-index: -1;
        }

        .progressbar li:first-child:after {
            content: none;
        }

        .progressbar li.active {
            color: #0072ff;
        }

        .progressbar li.active:before {
            border-color: #0072ff;
            background: linear-gradient(90deg, #0072ff 0%, #00c6ff 100%);
            color: #fff;
        }

        .progressbar li.active+li:after {
            background: linear-gradient(90deg, #0072ff 0%, #00c6ff 100%);
        }

        .preview-section {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .preview-section h3 {
            color: #0072ff;
            margin-bottom: 20px;
        }

        .preview-row {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .preview-label {
            font-weight: 600;
            color: #0a2540;
        }

        .preview-value {
            color: #666;
        }

        .preview-photo {
            max-width: 150px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .preview-signature {
            max-width: 200px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }

        .download-btn {
            margin-top: 20px;
            background: linear-gradient(90deg, #0072ff 0%, #00c6ff 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,114,255,0.3);
        }

        .col-md-6, .col-md-4 {
            position: relative;
            margin-bottom: 2rem;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="form-container">
            <h2 class="text-center mb-4">A J Securitas Recruitment Form</h2>
            <ul class="progressbar" id="progressbar">
                <li class="active">Personal</li>
                <li>Other Details</li>
                <li>Educational</li>
            </ul>
            <form id="recruitmentForm" enctype="multipart/form-data">
                <!-- Step 1: Personal Details -->
                <div class="form-step active" id="step-1">
                    <h4 class="mb-3">Personal</h4>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Name</label>
                            <input type="text" class="form-control" name="name" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Father's Name</label>
                            <input type="text" class="form-control" name="fatherName" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Mother's Name</label>
                            <input type="text" class="form-control" name="motherName" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Date of Birth</label>
                            <input type="date" class="form-control" name="dob" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Mobile Number</label>
                            <input type="tel" class="form-control" name="mobile1" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Marital Status</label>
                            <select class="form-select" name="maritalStatus" required>
                                <option value="">Select</option>
                                <option value="single">Single</option>
                                <option value="married">Married</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Nationality</label>
                            <input type="text" class="form-control" name="nationality" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Caste</label>
                            <select class="form-select" name="caste" required>
                                <option value="">Select</option>
                                <option value="General">General</option>
                                <option value="OBC">OBC</option>
                                <option value="SC">SC</option>
                                <option value="ST">ST</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Identification Mark on Body</label>
                            <input type="text" class="form-control" name="identificationMark" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Physical Measurement (Height)</label>
                            <input type="text" class="form-control" name="height" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Chest</label>
                            <input type="text" class="form-control" name="chest" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Upload Passport Size Photo</label>
                            <input type="file" class="form-control" name="photo" accept="image/*" id="photoInput"
                                capture="environment" required>
                            <img id="photoPreview" class="passport-photo-preview" src="#" alt="Preview"
                                style="display:none;" />
                            <button type="button" class="btn btn-outline-primary mt-2" onclick="openCamera()">Take Photo
                                </button>
                        </div>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-primary" onclick="validateStep(1)">Next</button>
                    </div>
                </div>
                <!-- Step 2: Other Details -->
                <div class="form-step" id="step-2">
                    <h4 class="mb-3">Other Details</h4>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Aadhaar Number</label>
                            <input type="text" class="form-control" name="aadhaar" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">PAN Number</label>
                            <input type="text" class="form-control" name="pan" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label required-field">Bank Account Number</label>
                            <input type="text" class="form-control" name="bankAccount" required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label required-field">IFSC Code</label>
                            <input type="text" class="form-control" name="ifsc" required>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label required-field">Bank Name</label>
                            <input type="text" class="form-control" name="bankName" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Bank Branch</label>
                            <input type="text" class="form-control" name="bankBranch" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Experience (Optional)</label>
                            <input type="text" class="form-control" name="experience">
                        </div>
                    </div>
                    <div class="d-flex justify-content-between">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Back</button>
                        <button type="button" class="btn btn-primary" onclick="validateStep(2)">Next</button>
                    </div>
                </div>
                <!-- Step 3: Educational -->
                <div class="form-step" id="step-3">
                    <h4 class="mb-3">Educational</h4>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Educational Qualification</label>
                            <select class="form-select" name="education" required>
                                <option value="">Select</option>
                                <option value="10th">10th</option>
                                <option value="12th">12th</option>
                                <option value="Graduate">Graduate</option>
                                <option value="Post Graduate">Post Graduate</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Board/University</label>
                            <input type="text" class="form-control" name="board" required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label required-field">Year of Passing</label>
                            <input type="text" class="form-control" name="passingYear" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label required-field">Percentage/Grade</label>
                            <input type="text" class="form-control" name="percentage" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label required-field">Signature</label>
                        <input type="file" class="form-control" name="signatureImage" accept="image/*" id="signatureInput"
                            required>
                        <img id="signaturePreview" class="passport-photo-preview" src="#" alt="Signature Preview"
                            style="display:none; width:180px; height:60px; object-fit:contain; border:2px solid #0072ff; margin-top:10px;" />
                    </div>
                    <div class="alert alert-info">
                        Uniform Details - Shirt, Pant, Belt, Shoes, Cap, Lanyard, Flap, Jersey, Jacket
                    </div>
                    <div class="d-flex justify-content-between">
                        <button type="button" class="btn btn-secondary" onclick="prevStep(3)">Back</button>
                        <button type="submit" class="btn btn-success">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Multi-step form navigation
        function nextStep(current) {
            document.getElementById('step-' + current).classList.remove('active');
            document.getElementById('step-' + (current + 1)).classList.add('active');
            updateProgressBar(current + 1);
        }

        function prevStep(current) {
            document.getElementById('step-' + current).classList.remove('active');
            document.getElementById('step-' + (current - 1)).classList.add('active');
            updateProgressBar(current - 1);
        }

        // Passport photo preview
        const photoInput = document.getElementById('photoInput');
        const photoPreview = document.getElementById('photoPreview');
        photoInput.addEventListener('change', function (e) {
            const [file] = e.target.files;
            if (file) {
                const reader = new FileReader();
                reader.onload = function (evt) {
                    photoPreview.src = evt.target.result;
                    photoPreview.style.display = 'block';
                };
                reader.readAsDataURL(file);
            } else {
                // If user cancels, hide preview
                photoPreview.src = '#';
                photoPreview.style.display = 'none';
            }
        });

        // Signature image preview
        document.getElementById('signatureInput').addEventListener('change', function (e) {
            const [file] = e.target.files;
            if (file) {
                const reader = new FileReader();
                reader.onload = function (evt) {
                    const img = document.getElementById('signaturePreview');
                    img.src = evt.target.result;
                    img.style.display = 'block';
                };
                reader.readAsDataURL(file);
            }
        });

        // Update progress bar
        function updateProgressBar(step) {
            const steps = document.querySelectorAll('.progressbar li');
            steps.forEach((el, index) => {
                el.classList.remove('active');
                if (index < step) {
                    el.classList.add('active');
                }
            });
        }

        // Validation functions
        function validateName(name) {
            return /^[a-zA-Z\s]{2,50}$/.test(name);
        }

        function validateMobile(mobile) {
            return /^[6-9]\d{9}$/.test(mobile);
        }

        function validateAadhaar(aadhaar) {
            return /^\d{12}$/.test(aadhaar);
        }

        function validatePAN(pan) {
            return /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(pan);
        }

        function validateIFSC(ifsc) {
            return /^[A-Z]{4}0[A-Z0-9]{6}$/.test(ifsc);
        }

        function validateBankAccount(account) {
            return /^\d{9,18}$/.test(account);
        }

        function validatePercentage(percentage) {
            const value = parseFloat(percentage);
            return !isNaN(value) && value >= 0 && value <= 100;
        }

        function validateYear(year) {
            const currentYear = new Date().getFullYear();
            const value = parseInt(year);
            return !isNaN(value) && value >= 1950 && value <= currentYear;
        }

        // Function to show error message
        function showError(input, message) {
            // Find the parent row div
            const rowDiv = input.closest('.row');
            // Find the specific column div containing this input
            const colDiv = input.closest('.col-md-6, .col-md-4');
            // Create or get the error message div
            let errorDiv = colDiv.querySelector('.error-message');
            
            if (!errorDiv) {
                errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                // Insert error message after the input
                colDiv.appendChild(errorDiv);
            }
            
            errorDiv.textContent = message;
            input.classList.add('is-invalid');
        }

        // Function to clear error message
        function clearError(input) {
            // Find the specific column div containing this input
            const colDiv = input.closest('.col-md-6, .col-md-4');
            const errorDiv = colDiv.querySelector('.error-message');
            
            if (errorDiv) {
                errorDiv.remove();
            }
            
            input.classList.remove('is-invalid');
        }

        // Add input event listeners for real-time validation
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('recruitmentForm');
            
            // Name validation
            form.name.addEventListener('input', function() {
                if (!validateName(this.value)) {
                    showError(this, 'Name should only contain letters and spaces (2-50 characters)');
                } else {
                    clearError(this);
                }
            });

            // Mobile validation
            form.mobile1.addEventListener('input', function() {
                if (!validateMobile(this.value)) {
                    showError(this, 'Please enter a valid 10-digit mobile number starting with 6-9');
                } else {
                    clearError(this);
                }
            });

            // Aadhaar validation
            form.aadhaar.addEventListener('input', function() {
                if (!validateAadhaar(this.value)) {
                    showError(this, 'Please enter a valid 12-digit Aadhaar number');
                } else {
                    clearError(this);
                }
            });

            // PAN validation
            form.pan.addEventListener('input', function() {
                if (!validatePAN(this.value)) {
                    showError(this, 'Please enter a valid PAN number (e.g., ABCDE1234F)');
                } else {
                    clearError(this);
                }
            });

            // IFSC validation
            form.ifsc.addEventListener('input', function() {
                if (!validateIFSC(this.value)) {
                    showError(this, 'Please enter a valid IFSC code');
                } else {
                    clearError(this);
                }
            });

            // Bank Account validation
            form.bankAccount.addEventListener('input', function() {
                if (!validateBankAccount(this.value)) {
                    showError(this, 'Please enter a valid bank account number (9-18 digits)');
                } else {
                    clearError(this);
                }
            });

            // Percentage validation
            form.percentage.addEventListener('input', function() {
                if (!validatePercentage(this.value)) {
                    showError(this, 'Please enter a valid percentage (0-100)');
                } else {
                    clearError(this);
                }
            });

            // Year validation
            form.passingYear.addEventListener('input', function() {
                if (!validateYear(this.value)) {
                    showError(this, 'Please enter a valid year between 1950 and current year');
                } else {
                    clearError(this);
                }
            });

            // Date of Birth validation
            form.dob.addEventListener('input', function() {
                const dob = new Date(this.value);
                const today = new Date();
                const age = today.getFullYear() - dob.getFullYear();
                
                if (dob > today) {
                    showError(this, 'Date of birth cannot be in the future');
                } else if (age < 18) {
                    showError(this, 'Age must be at least 18 years');
                } else {
                    clearError(this);
                }
            });

            // Photo validation
            form.photo.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    if (!file.type.startsWith('image/')) {
                        showError(this, 'Please upload an image file');
                        this.value = '';
                    } else if (file.size > 5 * 1024 * 1024) { // 5MB limit
                        showError(this, 'Image size should be less than 5MB');
                        this.value = '';
                    } else {
                        clearError(this);
                    }
                }
            });

            // Signature validation
            form.signatureImage.addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    if (!file.type.startsWith('image/')) {
                        showError(this, 'Please upload an image file');
                        this.value = '';
                    } else if (file.size > 2 * 1024 * 1024) { // 2MB limit
                        showError(this, 'Image size should be less than 2MB');
                        this.value = '';
                    } else {
                        clearError(this);
                    }
                }
            });
        });

        // Update validateStep function
        function validateStep(step) {
            let valid = true;
            const stepDiv = document.getElementById('step-' + step);
            const inputs = stepDiv.querySelectorAll('input, select');
            
            // Clear all existing errors first
            inputs.forEach(input => {
                clearError(input);
            });
            
            inputs.forEach(input => {
                if (input.hasAttribute('required')) {
                    if (!input.value) {
                        showError(input, 'This field is required');
                        valid = false;
                    } else {
                        // Validate specific fields
                        switch(input.name) {
                            case 'name':
                                if (!validateName(input.value)) {
                                    showError(input, 'Name should only contain letters and spaces (2-50 characters)');
                                    valid = false;
                                }
                                break;
                            case 'mobile1':
                                if (!validateMobile(input.value)) {
                                    showError(input, 'Please enter a valid 10-digit mobile number starting with 6-9');
                                    valid = false;
                                }
                                break;
                            case 'aadhaar':
                                if (!validateAadhaar(input.value)) {
                                    showError(input, 'Please enter a valid 12-digit Aadhaar number');
                                    valid = false;
                                }
                                break;
                            case 'pan':
                                if (!validatePAN(input.value)) {
                                    showError(input, 'Please enter a valid PAN number (e.g., ABCDE1234F)');
                                    valid = false;
                                }
                                break;
                            case 'ifsc':
                                if (!validateIFSC(input.value)) {
                                    showError(input, 'Please enter a valid IFSC code');
                                    valid = false;
                                }
                                break;
                            case 'bankAccount':
                                if (!validateBankAccount(input.value)) {
                                    showError(input, 'Please enter a valid bank account number (9-18 digits)');
                                    valid = false;
                                }
                                break;
                            case 'percentage':
                                if (!validatePercentage(input.value)) {
                                    showError(input, 'Please enter a valid percentage (0-100)');
                                    valid = false;
                                }
                                break;
                            case 'passingYear':
                                if (!validateYear(input.value)) {
                                    showError(input, 'Please enter a valid year between 1950 and current year');
                                    valid = false;
                                }
                                break;
                        }
                    }
                }
            });

            if (valid) {
                nextStep(step);
            } else {
                // Scroll to first error
                const firstError = stepDiv.querySelector('.is-invalid');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }

        // Optional: Prevent form submit for demo
        document.getElementById('recruitmentForm').addEventListener('submit', function (e) {
            e.preventDefault();
            
            // Create preview section
            const previewSection = document.createElement('div');
            previewSection.className = 'preview-section';
            previewSection.innerHTML = `
                <h3 class="text-center mb-4">Application Preview</h3>
                <div class="row">
                    <div class="col-md-6">
                        <div class="preview-row">
                            <div class="preview-label">Name:</div>
                            <div class="preview-value">${this.name.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Father's Name:</div>
                            <div class="preview-value">${this.fatherName.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Mother's Name:</div>
                            <div class="preview-value">${this.motherName.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Date of Birth:</div>
                            <div class="preview-value">${this.dob.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Mobile Number:</div>
                            <div class="preview-value">${this.mobile1.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Marital Status:</div>
                            <div class="preview-value">${this.maritalStatus.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Nationality:</div>
                            <div class="preview-value">${this.nationality.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Caste:</div>
                            <div class="preview-value">${this.caste.value}</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="preview-row">
                            <div class="preview-label">Identification Mark:</div>
                            <div class="preview-value">${this.identificationMark.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Height:</div>
                            <div class="preview-value">${this.height.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Chest:</div>
                            <div class="preview-value">${this.chest.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Photo:</div>
                            <div class="preview-value">
                                <img src="${document.getElementById('photoPreview').src}" class="preview-photo">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="preview-row">
                            <div class="preview-label">Aadhaar Number:</div>
                            <div class="preview-value">${this.aadhaar.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">PAN Number:</div>
                            <div class="preview-value">${this.pan.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Bank Account:</div>
                            <div class="preview-value">${this.bankAccount.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">IFSC Code:</div>
                            <div class="preview-value">${this.ifsc.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Bank Name:</div>
                            <div class="preview-value">${this.bankName.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Bank Branch:</div>
                            <div class="preview-value">${this.bankBranch.value}</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="preview-row">
                            <div class="preview-label">Experience:</div>
                            <div class="preview-value">${this.experience.value || 'N/A'}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Education:</div>
                            <div class="preview-value">${this.education.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Board/University:</div>
                            <div class="preview-value">${this.board.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Year of Passing:</div>
                            <div class="preview-value">${this.passingYear.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Percentage/Grade:</div>
                            <div class="preview-value">${this.percentage.value}</div>
                        </div>
                        <div class="preview-row">
                            <div class="preview-label">Signature:</div>
                            <div class="preview-value">
                                <img src="${document.getElementById('signaturePreview').src}" class="preview-signature">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-4">
                    <button class="download-btn" onclick="downloadPDF()">
                        <i class="fas fa-download"></i> Download Application
                    </button>
                    <button class="edit-btn" onclick="editForm()" style="margin-left: 10px; background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; transition: all 0.3s ease;">
                        <i class="fas fa-edit"></i> Edit Form
                    </button>
                </div>
            `;

            // Add preview section after form
            this.parentElement.appendChild(previewSection);
            previewSection.style.display = 'block';

            // Hide form
            this.style.display = 'none';
        });

        // Function to edit form
        function editForm() {
            // Show the form
            const form = document.getElementById('recruitmentForm');
            form.style.display = 'block';
            
            // Remove preview section
            const previewSection = document.querySelector('.preview-section');
            if (previewSection) {
                previewSection.remove();
            }
            
            // Scroll to top of form
            form.scrollIntoView({ behavior: 'smooth' });
        }

        // Function to download PDF
        async function downloadPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Set font styles
            doc.setFont("helvetica", "bold");
            doc.setFontSize(16);
            
            // Add title
            doc.text("A J Securitas Recruitment Form", 105, 20, { align: "center" });
            
            // Reset font for content
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            
            // Get form data
            const form = document.getElementById('recruitmentForm');
            const formData = new FormData(form);
            
            // Personal Details Section
            doc.setFont("helvetica", "bold");
            doc.setFontSize(12);
            doc.text("Personal Details", 20, 35);
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            
            let y = 45;
            const lineHeight = 7;
            const leftMargin = 20;
            const rightMargin = 100;
            
            // Personal Information
            doc.text("Name: " + formData.get('name'), leftMargin, y);
            doc.text("Father's Name: " + formData.get('fatherName'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Mother's Name: " + formData.get('motherName'), leftMargin, y);
            doc.text("Date of Birth: " + formData.get('dob'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Mobile Number: " + formData.get('mobile1'), leftMargin, y);
            doc.text("Marital Status: " + formData.get('maritalStatus'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Nationality: " + formData.get('nationality'), leftMargin, y);
            doc.text("Caste: " + formData.get('caste'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Identification Mark: " + formData.get('identificationMark'), leftMargin, y);
            y += lineHeight;
            
            doc.text("Height: " + formData.get('height'), leftMargin, y);
            doc.text("Chest: " + formData.get('chest'), rightMargin, y);
            y += lineHeight * 2;
            
            // Other Details Section
            doc.setFont("helvetica", "bold");
            doc.setFontSize(12);
            doc.text("Other Details", 20, y);
            y += lineHeight;
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            
            doc.text("Aadhaar Number: " + formData.get('aadhaar'), leftMargin, y);
            doc.text("PAN Number: " + formData.get('pan'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Bank Account: " + formData.get('bankAccount'), leftMargin, y);
            doc.text("IFSC Code: " + formData.get('ifsc'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Bank Name: " + formData.get('bankName'), leftMargin, y);
            doc.text("Bank Branch: " + formData.get('bankBranch'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Experience: " + (formData.get('experience') || 'N/A'), leftMargin, y);
            y += lineHeight * 2;
            
            // Educational Details Section
            doc.setFont("helvetica", "bold");
            doc.setFontSize(12);
            doc.text("Educational Details", 20, y);
            y += lineHeight;
            
            doc.setFont("helvetica", "normal");
            doc.setFontSize(10);
            
            doc.text("Education: " + formData.get('education'), leftMargin, y);
            doc.text("Board/University: " + formData.get('board'), rightMargin, y);
            y += lineHeight;
            
            doc.text("Year of Passing: " + formData.get('passingYear'), leftMargin, y);
            doc.text("Percentage/Grade: " + formData.get('percentage'), rightMargin, y);
            y += lineHeight * 2;
            
            // Add photo if available
            const photoPreview = document.getElementById('photoPreview');
            if (photoPreview && photoPreview.src) {
                try {
                    const photoData = await getBase64FromUrl(photoPreview.src);
                    doc.addImage(photoData, 'JPEG', leftMargin, y, 30, 40);
                    doc.text("Photo", leftMargin, y + 45);
                } catch (error) {
                    console.error('Error adding photo:', error);
                }
            }
            
            // Add signature if available
            const signaturePreview = document.getElementById('signaturePreview');
            if (signaturePreview && signaturePreview.src) {
                try {
                    const signatureData = await getBase64FromUrl(signaturePreview.src);
                    doc.addImage(signatureData, 'JPEG', rightMargin, y, 40, 20);
                    doc.text("Signature", rightMargin, y + 25);
                } catch (error) {
                    console.error('Error adding signature:', error);
                }
            }
            
            // Add footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.text(
                    'Page ' + i + ' of ' + pageCount,
                    doc.internal.pageSize.width / 2,
                    doc.internal.pageSize.height - 10,
                    { align: 'center' }
                );
            }
            
            // Save the PDF
            doc.save('application_form.pdf');
        }
        
        // Helper function to convert image URL to base64
        function getBase64FromUrl(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.crossOrigin = 'Anonymous';
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width;
                    canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    const dataURL = canvas.toDataURL('image/jpeg');
                    resolve(dataURL);
                };
                img.onerror = reject;
                img.src = url;
            });
        }

        // Camera capture for passport photo
        async function openCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        facingMode: 'environment',
                        width: { ideal: 1280 },
                        height: { ideal: 720 }
                    } 
                });
                
                // Create video element
                const video = document.createElement('video');
                video.srcObject = stream;
                video.autoplay = true;
                video.style.width = '100%';
                video.style.maxWidth = '400px';
                video.style.borderRadius = '8px';
                
                // Create capture button
                const captureBtn = document.createElement('button');
                captureBtn.className = 'btn btn-primary mt-2';
                captureBtn.textContent = 'Capture Photo';
                
                // Create container for camera view
                const cameraContainer = document.createElement('div');
                cameraContainer.style.textAlign = 'center';
                cameraContainer.appendChild(video);
                cameraContainer.appendChild(captureBtn);
                
                // Replace the existing button with camera view
                const photoSection = document.querySelector('input[name="photo"]').parentElement;
                const oldButton = photoSection.querySelector('button');
                photoSection.insertBefore(cameraContainer, oldButton);
                oldButton.style.display = 'none';
                
                // Handle photo capture
                captureBtn.onclick = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    canvas.getContext('2d').drawImage(video, 0, 0);
                    
                    // Convert to blob and create file
                    canvas.toBlob((blob) => {
                        const file = new File([blob], 'photo.jpg', { type: 'image/jpeg' });
                        const dataTransfer = new DataTransfer();
                        dataTransfer.items.add(file);
                        
                        // Update file input
                        const fileInput = document.getElementById('photoInput');
                        fileInput.files = dataTransfer.files;
                        
                        // Show preview
                        const preview = document.getElementById('photoPreview');
                        preview.src = URL.createObjectURL(blob);
                        preview.style.display = 'block';
                        
                        // Clean up
                        stream.getTracks().forEach(track => track.stop());
                        cameraContainer.remove();
                        oldButton.style.display = 'block';
                    }, 'image/jpeg');
                };
            } catch (err) {
                console.error('Error accessing camera:', err);
                alert('Unable to access camera. Please make sure you have granted camera permissions.');
            }
        }
    </script>
</body>

</html>
